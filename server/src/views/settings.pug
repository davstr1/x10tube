extends layout

block content
  section.mb-8
    h1.text-xl.font-semibold.text-text-primary.mb-2 Settings
    p.text-sm.text-text-muted Configure your StraightToYourAI experience.

  if saved
    .bg-green-900.border.border-green-700.text-green-200.rounded-lg.p-4.mb-6.text-sm
      | Settings saved successfully.

  form(method="POST" action="/settings")
    //- YouTube Power Mode
    section.bg-surface.border.border-border-default.rounded-lg.mb-6(style="padding: 1.5rem;")
      .flex.items-start.justify-between.gap-4
        div
          h2.text-base.font-medium.text-text-primary.mb-2 YouTube Power Mode
          p.text-sm.text-text-secondary
            | Show icons next to video titles on YouTube.
            br
            | Click them to quickly add videos without opening each one.
        label.flex-shrink-0(style="cursor: pointer;")
          input(type="checkbox" name="youtube_power_mode" checked=(settings.youtube_power_mode !== false) style="display: none;")
          .toggle-switch(style="width: 44px; height: 24px; border-radius: 12px; position: relative; transition: background 0.2s;" class=(settings.youtube_power_mode !== false ? "bg-red-600" : "bg-surface-alt"))
            .toggle-knob(style="width: 20px; height: 20px; border-radius: 10px; background: white; position: absolute; top: 2px; transition: left 0.2s;" class=(settings.youtube_power_mode !== false ? "" : "") data-checked=(settings.youtube_power_mode !== false))

    //- Submit
    .flex.items-center.gap-4
      button.bg-red-600.hover_bg-red-700.text-white.font-medium.rounded-lg.px-6.py-2.transition-colors(type="submit") Save settings
      a.text-sm.text-text-muted.hover_text-text-secondary(href="/collections") Cancel

  //- User code section
  section.mt-12.pt-6.border-t.border-border-default
    h2.text-base.font-medium.text-text-primary.mb-2 Your user code
    p.text-sm.text-text-muted.mb-4 Use this code to access your collections from another device.
    .bg-surface-alt.rounded-lg.p-4.font-mono.text-sm.text-text-primary= userCode

  script.
    // Toggle switch JavaScript
    document.querySelectorAll('label').forEach(label => {
      const checkbox = label.querySelector('input[type="checkbox"]');
      const toggleSwitch = label.querySelector('.toggle-switch');
      const knob = label.querySelector('.toggle-knob');

      if (checkbox && toggleSwitch && knob) {
        // Set initial state
        updateToggle();

        checkbox.addEventListener('change', updateToggle);

        function updateToggle() {
          if (checkbox.checked) {
            toggleSwitch.style.background = '#dc2626';
            knob.style.left = '22px';
          } else {
            toggleSwitch.style.background = '#3f3f3f';
            knob.style.left = '2px';
          }
        }
      }
    });
